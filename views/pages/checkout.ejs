<head>
    <%- include('../common/head')%>

        <%- include('../common/homestyle') %>
</head>


<body>
    <header>
        <%- include('../common/header', { links: navbar.links }) %>
    </header>

    <div class="container">
        <div class="final">
            <br>
            <h5 style="display: inline-block;">Total sum to pay:</h5>
            <h5 style="display: inline-block;"><%- include('../common/finalSumToPay')%></h5>
        </div>
    </div>
    <br><br><br>

    <products>
        <div class="container">
            <div class="inside">
                <% products.forEach((product)=> { %>
                    <br><br><br>
                    <div class="entry" data-product-id="<%= product._id %>">


                        <div class="product-info">
                            <img class="product-image" src="<%= product.image %>" alt="Product Image">
                            <div class="product-details">
                                <h5 class="product-title">
                                    <%= product.title %>
                                </h5>
                                <p class="product-category">Category: <%= product.category %>
                                </p>
                                <p class="product-p">quantity: <%= product.quantity %>
                                </p>
                                <p class="product-p">Price: $<%= product.price %>
                                </p>
                                <p class="product-price">Total: $<%= product.quantity * product.price%>
                                </p>
                            </div>
                        </div>
                        <a class="btn btn-primary remove-checkout" role="button" data-price="<%= product.price %>"
                            onclick="removeEntry(this)">Remove item from
                            cart</a>
                    </div>

                    <% }); %>
            </div>




        </div>


        <script>
            function removeEntry(button) {

                const entryElement = button.closest('.entry');
                if (entryElement) {
                    entryElement.style.display = 'none';
                }
                setTimeout(() => {
                    window.location.reload();
                }, 250);


            }


        </script>

    </products>

    <payment>
        <div class="container">
            <h1 class="text-center mt-5">Checkout Payment</h1>
            <div class="row justify-content-center">
                <div class="col-md-6">
                    <form method="post" action="/payment" id="paymentForm">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input name="name" type="text" class="form-control" id="name" placeholder="Enter your name"
                                required>
                        </div>

                        <div class="form-group">
                            <label for="mail">Your Email</label>
                            <input name="mail" type="email" class="form-control" id="email"
                                placeholder="Enter your email" required>
                        </div>

                        <div class="form-group">
                            <label for="address">Address</label>
                            <input type="text" name="address" class="form-control" id="address"
                                placeholder="Enter your address" required>
                        </div>
                        <div class="form-group">
                            <label for="billingAddress">Billing Address</label>
                            <input type="text" name="billingAddress" class="form-control" id="billingAddress"
                                placeholder="Enter your billing address" required>
                        </div>

                        <div class="form-group">
                            <label for="cardNumber">Card Number</label>
                            <input name="cardNumber" type="number" class="form-control" id="cardNumber"
                                placeholder="Enter your card number" required>
                        </div>
                        <div class="form-group">
                            <label for="cardHolder">Card Holder Name</label>
                            <input type="text" name="cardHolder" class="form-control" id="cardHolder"
                                placeholder="Enter card holder name" required>
                        </div>

                        <div class="form-group">
                            <label for="expiryDate">Expiry Date</label>
                            <input type="text" name="expiryDate" class="form-control" id="expiryDate"
                                placeholder="Enter expiry date (MM/YY)" required>
                        </div>

                        <div class="form-group">
                            <label for="cvv">CVV</label>
                            <input type="number" name="cvv" class="form-control" id="cvv" placeholder="Enter CVV"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="sum">Sum</label>
                            <span id="sum" class="form-control" readonly><%- include('../common/finalSumToPay')%></span>
                            <% var totalSum=0; %>
                                <div class="sum-none">
                                    <% products.forEach((product)=> { %>
                                        <br>
                                        <div class="sum-none-inside" data-product-id="<%= product._id %>">
                                            <script>
                                                <!-- <% totalSum=0; %>
                                                <% products.forEach((product)=> { %>
                                                    <% totalSum +=(product.price) * (product.quantity); %>
                                                        <% }); %> -->
                                            </script>
                                        </div>
                                        <% }); %>
                                </div>
                                <input type="hidden" name="totalSum" value="<%= totalSum %>">

                        </div>


                        <br>
                        <div class=" all">
                            <% products.forEach((product)=> { %>
                                <br>
                                <div class="list" data-product-id="<%= product._id %>">
                                    <h5>
                                        <%= product.title %> X <%= product.quantity%>
                                    </h5>
                                    <div>
                                        <span class="payment" style="color:red;">Total: $<%= product.quantity *
                                                product.price%></span>
                                    </div>
                                    <% }); %>
                                </div>

                                <div class="container">
                                    <br>
                                    <h5>Total sum to pay:</h5>
                                    <h5><%- include('../common/finalSumToPay')%></h5>
                                </div>

                                <button type="submit" id="submitBtn" class="btn btn-primary">Click to pay</button>

                        </div>
                    </form>
                </div>
            </div>
            <br><br>
        </div>
        <br><br>
    </payment>

    <%- include('../common/cart-control')%>
        <style>
            .total-sum-container {
                position: fixed;
                top: 10px;
                left: 44%;
                opacity: 0.8;
                max-width: 400px;
                z-index: 9999;
                display: none;
            }
        </style>

        <footer>
            <%- include('../common/footer')%>
        </footer>
</body>

</html>